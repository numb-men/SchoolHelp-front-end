(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/messages/message-detail/message-detail"],{"22ae":function(e,s,t){"use strict";(function(e){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=t("b575"),n={data:function(){return{myUserId:"",myHeadImg:"",messageInput:"",chat:{userName:"",userHeadImg:"",userId:"",isOnline:"",msgs:[]},bottomId:"",scrollHeight:900}},onLoad:function(s){var t=e.getSystemInfoSync();this.scrollHeight=t.windowHeight-80;var a=JSON.parse(s.detail);this.myUserId=this.$store.state.userInfo.id,this.chat.userId=a.chatUserId,this.getEasyUserInfo(),this.myHeadImg=this.$store.state.userInfo.headImageUrl,this.getMessageList()},methods:{getEasyUserInfo:function(){var s=this,t=this.$api.urls.getOtherUserInfo+this.chat.userId,a={};this.$api.req.get(t,a,function(t){console.log(t," at pages\\messages\\message-detail\\message-detail.vue:74"),s.chat.userHeadImg=t.data.headImageUrl,s.chat.userName=t.data.name,s.chat.isOnline=t.data.online,e.setNavigationBarTitle({title:s.chat.userName+"（".concat(s.chat.isOnline?"在线":"离线","）")})})},readAll:function(){var e=this.$api.urls.setMessageRead,s={messageId:[]};this.chat.msgs.map(function(e){e.isMe||e.state||s.messageId.push(e.id)}),s.messageId.length>0&&this.$api.req.put(e,s,function(e){console.log(e," at pages\\messages\\message-detail\\message-detail.vue:96")})},getMessageList:function(){var e=this,s=this.$api.urls.getMessageListForUser,t={accept:this.chat.userId};this.$api.req.get(s,t,function(s){e.chat.msgs=s.data.map(function(s,t){return{id:s.messageId,sendTime:(0,a.friendlyDate)(new Date(s.sendTime.replace(/\-/g,"/").replace(/\T/g," ").substring(0,19)).getTime()),isMe:s.send==e.myUserId,msgContent:s.messageContent,state:s.state}}),e.readAll(),e.bottomId="msg-"+e.chat.msgs[e.chat.msgs.length-1].id,console.log(e.bottomId," at pages\\messages\\message-detail\\message-detail.vue:115")})},sendMessage:function(){var e=this,s=this.$api.urls.sendMessage,t={messageContent:this.messageInput,accept:this.chat.userId};this.$api.req.post(s,t,function(s){console.log(s," at pages\\messages\\message-detail\\message-detail.vue:122"),e.getMessageList(),e.messageInput=""})}}};s.default=n}).call(this,t("6e42")["default"])},"2b6e":function(e,s,t){"use strict";t.r(s);var a=t("22ae"),n=t.n(a);for(var i in a)"default"!==i&&function(e){t.d(s,e,function(){return a[e]})}(i);s["default"]=n.a},a59d:function(e,s,t){"use strict";var a=t("dc0a"),n=t.n(a);n.a},b748:function(e,s,t){"use strict";t.r(s);var a=t("bb7f"),n=t("2b6e");for(var i in n)"default"!==i&&function(e){t.d(s,e,function(){return n[e]})}(i);t("a59d");var r=t("2877"),o=Object(r["a"])(n["default"],a["a"],a["b"],!1,null,null,null);s["default"]=o.exports},bb7f:function(e,s,t){"use strict";var a=function(){var e=this,s=e.$createElement;e._self._c},n=[];t.d(s,"a",function(){return a}),t.d(s,"b",function(){return n})},dc0a:function(e,s,t){}},[["0825","common/runtime","common/vendor"]]]);